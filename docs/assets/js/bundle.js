const b=(()=>{const i={};async function p(a){const n={allowed_pages:"./data/allowed_pages.json",commands:"./data/commands.json",contact:"./data/contact.json",technologies:"./data/technologies.json",tokens:"./data/tokens.json"};if(!n[a])throw console.error("El archivo json no existe."),new Error("El archivo json no existe.");if(i[a])return i[a];try{const o=await fetch(n[a]);if(!o.ok)throw new Error(`Error HTTP: ${o.status}`);const s=await o.json();return i[a]=s,s}catch(o){throw console.error("Error al cargar el JSON:",o),o}}return{obtenerDataJson:p}})(),R=(()=>{const i=new Map,p=["sobre_mi.css"],a={"sobre_mi.css":"./assets/css/sobre_mi.css"};return{cargar:function(n,{forzarRecarga:o=!0}={}){if(!p.includes(n)||!(n in a))return console.log("No, no..."),!1;const s=a[n],c=n.split(".").pop();return new Promise((m,d)=>{if(c==="css"){if(i.has(n)&&!o){m();return}i.has(n)&&(i.get(n).remove(),i.delete(n));const u=document.createElement("link");u.rel="stylesheet",u.href=s,u.onload=()=>{i.set(n,u),m()},u.onerror=d,document.head.appendChild(u)}else console.log("Tipo de archivo no soportado."),d(new Error("Tipo de archivo no soportado."))})},eliminar:function(n){if(!p.includes(n))return console.log("No, no..."),!1;n.split(".").pop()==="css"&&i.has(n)&&(i.get(n).remove(),i.delete(n))},estaCargado:function(n){return n.split(".").pop()==="css"?i.has(n):!1}}})(),y=(()=>{const i={inicio:()=>{j()},header:()=>{},consola:()=>{},contacto:()=>{},proyectos:()=>{},habilidades:()=>{},sobre_mi:()=>{R.cargar("sobre_mi.css")},experiencia:()=>{}};function p(a,n="section"){b.obtenerDataJson("allowed_pages").then(o=>{const s=o.idDOMPermitidos,c=o.rutasPermitidas;if(!s.includes(n))throw console.error(`El ID '${n}' no está permitido.`),new Error(`El ID '${n}' no está permitido.`);if(!c[a])throw console.error(`El módulo '${a}' no está permitido.`),new Error(`El módulo '${a}' no está permitido.`);return fetch(c[a])}).then(o=>{if(!o.ok)throw new Error(`Error HTTP: ${o.status}`);return o.text()}).then(o=>{const s=document.getElementById(n);s.innerHTML=o;const c=new CustomEvent("moduloCargado",{detail:{modulo:a,idperm:n}});s.dispatchEvent(c),i[a]()}).catch(o=>{throw console.error("Error al cargar el módulo:",o),o})}return{cargaModulo:p}})();function j(i="muestra_consola"){const p=document.getElementById("I_AM");p&&window.innerWidth>=900&&(p.style.height=`${window.innerHeight-54}px`),y.cargaModulo("consola",i);const a=document.getElementById(i);a.addEventListener("moduloCargado",function(n){if(n.detail.modulo==="consola"&&!a.querySelector(".consola_content")){console.log("consola no cargada ");return}},{once:!0})}function q(i){i.addEventListener("scroll",function(n){console.log(n)});const p={ArrowUp:"up",ArrowDown:"down"};if(i._listenerAgregado)return;i._listenerAgregado=!0,i.addEventListener("keydown",function(n){if(n.key==="ArrowUp"||n.key==="ArrowDown"){let o=a(n);w.comans(p[n.key],o[1])}if(n.key==="Enter"){let o=a(n);if(o[2]){const s=o[2].replace(/^root@Antonio_Segura:~#\s*/,"");s!=""?w.lexico(s).then(c=>{if(c.result===2){w.limpiaPantalla(n);return}w.insertaNuevoP(o[1],c.token)}):w.insertaNuevoP(o[1])}}});function a(n){n.preventDefault();const o=i.querySelectorAll("p"),s=o[o.length-1],c=s.id,m=s.innerText.trim();return{1:c,2:m}}}const w=(()=>{let i=[],p=[],a={},n=!1,o=!1,s=[],c={};const m=[];let d=-1;async function u(){if(n)return;if(o)return new Promise(t=>s.push(t));o=!0;const e=await b.obtenerDataJson("tokens");i=e.tokens,p=e.directorios,a=e.sintaxis,c=e.significado,n=!0,o=!1,s.forEach(t=>t()),s=[]}async function C(e){await u();const t=e.trim().split(/\s+/),r=[];m.push(e),d=m.length;for(let l=0;l<t.length;l++){const f=t[l].replace(/^\.(\/|\\)/,"");if(r.push(f),!i.includes(f))return{result:"-1",token:`'${t[l]}' no es un comando válido`}}return E(r,r.length)}function E(e,t){if(t===1)return Array.isArray(a[1])&&a[1].includes(e[0])?A(e,t):{result:"-1",token:`Comando inválido: '${e[0]}'`};if(t===2){if(!a.hasOwnProperty(e[0]))return{result:"-1",token:`Comando no reconocido: '${e[0]}'`};const r=a[e[0]];return Array.isArray(r)?r.includes(e[1])?A(e,t):{result:"-1",token:`Argumento inválido para '${e[0]}': '${e[1]}'`}:{result:"-1",token:`Configuración inválida para el comando: '${e[0]}'`}}return{result:"-1",token:"Error de sintaxis general"}}function A(e,t){if(t===1&&(e[0]==="--help"||e[0]==="/?")){const g=v();return{result:g.number,token:g.text}}if(t==2&&(e[1]==="--help"||e[1]==="/?")){const g=v(e[0]);return{result:g.number,token:g.text}}if(t==1&&(e[0]=="cls"||e[0]=="clear"))return{result:2,token:""};const r={ls:g=>P(g),cd:g=>L(),dir:g=>P(g),wget:g=>I(g)};let l="";(e[0]=="ls"||e[0]=="dir")&&(l="todos");const f=r[e[0]](t>1?e[1]:l);return{result:f.number,token:f.text}}function I(e){if(e==="cv"){const t="./document/Jose_Antonio_Rodriguez_Segura.pdf",r=document.createElement("a");return r.href=t,r.download="Jose_Antonio_Rodriguez_Segura.pdf",document.body.appendChild(r),r.click(),document.body.removeChild(r),{number:1,text:"Descargando curriculum vitae..."}}}function _(e,t="comand-0"){let r={up:-1,down:1}[e];if(d+=r,d<0)d=0;else if(d>=m.length)return d=m.length,"";$(t,m[d])}function $(e,t){const r=document.getElementById(e);r&&(r.textContent="root@Antonio_Segura:~# "+t,x(e))}function P(e="todos"){return e==="todos"?{number:1,text:p.join(`
`)}:p.includes(e)?{number:1,text:e}:{number:-1,text:`El directorio '${e}' no existe.`}}function v(e=""){let t="";if(e==="")for(const r in c){const l=c[r];t+=`> ${r}
`,Array.isArray(l)?t+=l.map(f=>`  ${f}`).join(`
`)+`

`:t+=`  ${l}

`}else{if(!c.hasOwnProperty(e))return{number:-1,text:`No hay información de ayuda para '${e}'`};const r=c[e];t+=`> ${e}
`,Array.isArray(r)?t+=r.map(l=>`  ${l}`).join(`
`):t+=`  ${r}`}return{number:3,text:t}}function L(e){return{number:4,text:""}}function M(e,t=""){let r=S(e);t!==""&&D(r,t)}function x(e){const t=document.getElementById(e);if(!t)return;t.focus&&t.focus();const r=document.createRange(),l=window.getSelection();r.selectNodeContents(t),r.collapse(!1),l.removeAllRanges(),l.addRange(r);const f=t.closest(".consola_content");if(!f)return;const g=t.getBoundingClientRect(),h=f.getBoundingClientRect();(g.bottom>h.bottom||g.top<h.top)&&(f.scrollTop=t.offsetTop-f.offsetTop)}function S(e,t="",r="~"){let l="";var f="";let g="afterend";if(t===""){if(f=document.getElementById(e),!f)return;f.classList.remove("prompt");const[T,N]=e.split("-"),B=parseInt(N)+1;l=`${T}-${B}`}else f=t.target,l="comand-0",g="afterbegin";const h=document.createElement("p");return h.className="prompt",h.id=l,h.textContent="root@Antonio_Segura:"+r+"# ",f.insertAdjacentElement(g,h),x(l),l}function D(e,t){const r=document.getElementById(e),l=document.createElement("span");l.textContent=t,r.insertAdjacentElement("beforebegin",l)}function k(e){e.target.innerHTML="",S("",e)}return{lexico:C,insertaNuevoP:M,limpiaPantalla:k,comans:_}})();window.agregarEventosInput=q;const J=(()=>{function i(s){const c=s.currentTarget.querySelectorAll("ul"),d=[".menu ul.menu-Principal",".menu ul.menu-flotante"][c.length-1],u=s.currentTarget.querySelector(d);u&&p(s,u,c.length-1==1)}function p(s,c,m=!1){const d=c.querySelectorAll("li"),u=s.target.closest("li");u&&c.contains(u)?a(d,u,m):n(s,c)}function a(s,c,m){try{const d=c.dataset.modulo||c.textContent.trim().toLowerCase();if(y.cargaModulo(d),s.forEach(u=>u.classList.remove("selected")),c.classList.add("selected"),m){const u=document.querySelector(".menu ul.menu-Principal");u&&u.querySelectorAll("li").forEach(E=>{E.classList.remove("selected"),(E.dataset.modulo||E.textContent.trim().toLowerCase())===d&&E.classList.add("selected")}),o()}}catch(d){alert(d)}}function n(s,c){if(o()==="cerrado")return;const m=document.createElement("ul");m.className="menu-flotante fadeInDown",c.querySelectorAll("li").forEach(u=>{m.appendChild(u.cloneNode(!0))}),s.target.insertAdjacentElement("afterend",m)}function o(){const s=document.querySelector(".menu-flotante");return s?(s.classList.remove("fadeInDown"),s.classList.add("fadeInUp-Menu"),setTimeout(()=>{s.remove()},750),"cerrado"):"continua"}return{menuActivo:i}})();document.addEventListener("DOMContentLoaded",()=>{y.cargaModulo("inicio"),document.getElementById("header").addEventListener("click",J.menuActivo)});
