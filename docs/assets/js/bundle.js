const _=(()=>{const c={};async function l(i){const t={allowed_pages:"./data/allowed_pages.json",commands:"./data/commands.json",contact:"./data/contact.json",technologies:"./data/technologies.json",tokens:"./data/tokens.json"};if(!t[i])throw console.error("El archivo json no existe."),new Error("El archivo json no existe.");if(c[i])return c[i];try{const n=await fetch(t[i]);if(!n.ok)throw new Error(`Error HTTP: ${n.status}`);const r=await n.json();return c[i]=r,r}catch(n){throw console.error("Error al cargar el JSON:",n),n}}return{obtenerDataJson:l}})(),E=(()=>{let c=[],l=[],i={},t=!1,n=!1,r=[],a={};const f=[];let m=-1;async function d(){if(t)return;if(n)return new Promise(o=>r.push(o));n=!0;const e=await _.obtenerDataJson("tokens");c=e.tokens,l=e.directorios,i=e.sintaxis,a=e.significado,t=!0,n=!1,r.forEach(o=>o()),r=[]}async function A(e){await d();const o=e.trim().split(/\s+/),s=[];f.push(e),m=f.length;for(let u=0;u<o.length;u++){const g=o[u].replace(/^\.(\/|\\)/,"");if(s.push(g),!c.includes(g))return{result:"-1",token:`'${o[u]}' no es un comando válido`}}return y(s,s.length)}function y(e,o){if(o===1)return Array.isArray(i[1])&&i[1].includes(e[0])?b(e,o):{result:"-1",token:`Comando inválido: '${e[0]}'`};if(o===2){if(!i.hasOwnProperty(e[0]))return{result:"-1",token:`Comando no reconocido: '${e[0]}'`};const s=i[e[0]];return Array.isArray(s)?s.includes(e[1])?b(e,o):{result:"-1",token:`Argumento inválido para '${e[0]}': '${e[1]}'`}:{result:"-1",token:`Configuración inválida para el comando: '${e[0]}'`}}return{result:"-1",token:"Error de sintaxis general"}}function b(e,o){if(o===1&&(e[0]==="--help"||e[0]==="/?")){const p=x();return{result:p.number,token:p.text}}if(o==2&&(e[1]==="--help"||e[1]==="/?")){const p=x(e[0]);return{result:p.number,token:p.text}}if(o==1&&(e[0]=="cls"||e[0]=="clear"))return{result:2,token:""};const s={ls:p=>v(p),cd:p=>M(),dir:p=>v(p),wget:p=>I(p)};let u="";(e[0]=="ls"||e[0]=="dir")&&(u="todos");const g=s[e[0]](o>1?e[1]:u);return{result:g.number,token:g.text}}function I(e){if(e==="cv"){const o="./document/Jose_Antonio_Rodriguez_Segura.pdf",s=document.createElement("a");return s.href=o,s.download="Jose_Antonio_Rodriguez_Segura.pdf",document.body.appendChild(s),s.click(),document.body.removeChild(s),{number:1,text:"Descargando curriculum vitae..."}}}function $(e,o="comand-0"){let s={up:-1,down:1}[e];if(m+=s,m<0)m=0;else if(m>=f.length)return m=f.length,"";L(o,f[m])}function L(e,o){const s=document.getElementById(e);s&&(s.textContent="root@Antonio_Segura:~# "+o,P(e))}function v(e="todos"){return e==="todos"?{number:1,text:l.join(`
`)}:l.includes(e)?{number:1,text:e}:{number:-1,text:`El directorio '${e}' no existe.`}}function x(e=""){let o="";if(e==="")for(const s in a){const u=a[s];o+=`> ${s}
`,Array.isArray(u)?o+=u.map(g=>`  ${g}`).join(`
`)+`

`:o+=`  ${u}

`}else{if(!a.hasOwnProperty(e))return{number:-1,text:`No hay información de ayuda para '${e}'`};const s=a[e];o+=`> ${e}
`,Array.isArray(s)?o+=s.map(u=>`  ${u}`).join(`
`):o+=`  ${s}`}return{number:3,text:o}}function M(e){return{number:4,text:""}}function D(e,o=""){let s=S(e);o!==""&&k(s,o)}function P(e){const o=document.getElementById(e);if(!o)return;o.focus&&o.focus();const s=document.createRange(),u=window.getSelection();s.selectNodeContents(o),s.collapse(!1),u.removeAllRanges(),u.addRange(s);const g=o.closest(".consola_content");if(!g)return;const p=o.getBoundingClientRect(),h=g.getBoundingClientRect();(p.bottom>h.bottom||p.top<h.top)&&(g.scrollTop=o.offsetTop-g.offsetTop)}function S(e,o="",s="~"){let u="";var g="";let p="afterend";if(o===""){if(g=document.getElementById(e),!g)return;g.classList.remove("prompt");const[N,B]=e.split("-"),q=parseInt(B)+1;u=`${N}-${q}`}else g=o.target,u="comand-0",p="afterbegin";const h=document.createElement("p");return h.className="prompt",h.id=u,h.textContent="root@Antonio_Segura:"+s+"# ",g.insertAdjacentElement(p,h),P(u),u}function k(e,o){const s=document.getElementById(e),u=document.createElement("span");u.textContent=o,s.insertAdjacentElement("beforebegin",u)}function T(e){e.target.innerHTML="",S("",e)}return{lexico:A,insertaNuevoP:D,limpiaPantalla:T,comans:$}})();function R(c){c.addEventListener("scroll",function(t){console.log(t)});const l={ArrowUp:"up",ArrowDown:"down"};if(c._listenerAgregado)return;c._listenerAgregado=!0,c.addEventListener("keydown",function(t){if(t.key==="ArrowUp"||t.key==="ArrowDown"){let n=i(t);E.comans(l[t.key],n[1])}if(t.key==="Enter"){let n=i(t);if(n[2]){const r=n[2].replace(/^root@Antonio_Segura:~#\s*/,"");r!=""?E.lexico(r).then(a=>{if(a.result===2){E.limpiaPantalla(t);return}E.insertaNuevoP(n[1],a.token)}):E.insertaNuevoP(n[1])}}});function i(t){t.preventDefault();const n=c.querySelectorAll("p"),r=n[n.length-1],a=r.id,f=r.innerText.trim();return{1:a,2:f}}}const w=(()=>{const c=new Map,l=["sobre_mi.css","contacto.css","experiencia.css","habilidades.css","inicio.css","proyectos.css","sobre_mi.css","consola.css","menu.css"],i={"sobre_mi.css":"./assets/css/modulos/sobre_mi.css","contacto.css":"./assets/css/modulos/contacto.css","experiencia.css":"./assets/css/modulos/experiencia.css","habilidades.css":"./assets/css/modulos/habilidades.css","inicio.css":"./assets/css/modulos/inicio.css","proyectos.css":"./assets/css/modulos/proyectos.css","consola.css":"./assets/css/componentes/consola.css","menu.css":"./assets/css/componentes/menu.css"};return{cargar:function(t,{forzarRecarga:n=!0}={}){if(!l.includes(t)||!(t in i))return console.log("No, no..."),!1;const r=i[t],a=t.split(".").pop();return new Promise((f,m)=>{if(a==="css"){if(c.has(t)&&!n){f();return}c.has(t)&&(c.get(t).remove(),c.delete(t));const d=document.createElement("link");d.rel="stylesheet",d.href=r,d.onload=()=>{c.set(t,d),f()},d.onerror=m,document.head.appendChild(d)}else console.log("Tipo de archivo no soportado."),m(new Error("Tipo de archivo no soportado."))})},eliminar:function(t){if(!l.includes(t))return console.log("No, no..."),!1;t.split(".").pop()==="css"&&c.has(t)&&(c.get(t).remove(),c.delete(t))},estaCargado:function(t){return t.split(".").pop()==="css"?c.has(t):!1}}})();function j(c="muestra_consola"){w.cargar("consola.css");const l=document.getElementById("I_AM");l&&window.innerWidth>=900&&(l.style.height=`${window.innerHeight-54}px`),C.cargaModulo("consola",c);const i=document.getElementById(c);i.addEventListener("moduloCargado",function(t){if(t.detail.modulo==="consola"&&!i.querySelector(".consola_content")){console.log("consola no cargada ");return}},{once:!0})}const H={init(){w.cargar("inicio.css"),j(),J()}};function J(c="[dev-antonio-titulo]"){const l=document.querySelector(c);l?(console.log("Ancho:",l.offsetWidth),console.log("Alto:",l.offsetHeight)):console.warn("No se encontró el elemento")}const O={init(){w.cargar("sobre_mi.css"),cargaConsola(),U()}};function U(c="[dev-antonio-titulo]"){const l=document.querySelector(c);l?(console.log("Ancho:",l.offsetWidth),console.log("Alto:",l.offsetHeight)):console.warn("No se encontró el elemento")}const C=(()=>{const c={inicio:()=>{H.init()},consola:()=>{},contacto:()=>{contacto.init()},proyectos:()=>{proyectos.init()},habilidades:()=>{habilidades.init()},sobre_mi:()=>{O.init()},experiencia:()=>{experiencia.init()}};function l(i,t="section"){_.obtenerDataJson("allowed_pages").then(n=>{const r=n.idDOMPermitidos,a=n.rutasPermitidas;if(!r.includes(t))throw console.error(`El ID '${t}' no está permitido.`),new Error(`El ID '${t}' no está permitido.`);if(!a[i])throw console.error(`El módulo '${i}' no está permitido.`),new Error(`El módulo '${i}' no está permitido.`);return fetch(a[i])}).then(n=>{if(!n.ok)throw new Error(`Error HTTP: ${n.status}`);return n.text()}).then(n=>{const r=document.getElementById(t);r.innerHTML=n;const a=new CustomEvent("moduloCargado",{detail:{modulo:i,idperm:t}});r.dispatchEvent(a),c[i]()}).catch(n=>{throw console.error("Error al cargar el módulo:",n),n})}return{cargaModulo:l}})(),W=(()=>{function c(r){const a=r.currentTarget.querySelectorAll("ul"),m=[".menu ul.menu-Principal",".menu ul.menu-flotante"][a.length-1],d=r.currentTarget.querySelector(m);d&&l(r,d,a.length-1==1)}function l(r,a,f=!1){const m=a.querySelectorAll("li"),d=r.target.closest("li");d&&a.contains(d)?i(m,d,f):t(r,a)}function i(r,a,f){try{const m=a.dataset.modulo||a.textContent.trim().toLowerCase();if(C.cargaModulo(m),r.forEach(d=>d.classList.remove("selected")),a.classList.add("selected"),f){const d=document.querySelector(".menu ul.menu-Principal");d&&d.querySelectorAll("li").forEach(y=>{y.classList.remove("selected"),(y.dataset.modulo||y.textContent.trim().toLowerCase())===m&&y.classList.add("selected")}),n()}}catch(m){alert(m)}}function t(r,a){if(n()==="cerrado")return;const f=document.createElement("ul");f.className="menu-flotante fadeInDown",a.querySelectorAll("li").forEach(d=>{f.appendChild(d.cloneNode(!0))}),r.target.insertAdjacentElement("afterend",f)}function n(){const r=document.querySelector(".menu-flotante");return r?(r.classList.remove("fadeInDown"),r.classList.add("fadeInUp-Menu"),setTimeout(()=>{r.remove()},750),"cerrado"):"continua"}return{menuActivo:c}})();document.addEventListener("DOMContentLoaded",()=>{C.cargaModulo("inicio"),document.getElementById("header").addEventListener("click",W.menuActivo),document.getElementById("section").addEventListener("keydown",i=>{i.target.matches(".consola_content")&&R(i.target)})});
