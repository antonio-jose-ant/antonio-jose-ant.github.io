const I=(()=>{const t={};async function r(a){const o={allowed_pages:"./data/allowed_pages.json",commands:"./data/commands.json",contact:"./data/contact.json",technologies:"./data/technologies.json",tokens:"./data/tokens.json"};if(!o[a])throw console.error("El archivo json no existe."),new Error("El archivo json no existe.");if(t[a])return t[a];try{const s=await fetch(o[a]);if(!s.ok)throw new Error(`Error HTTP: ${s.status}`);const c=await s.json();return t[a]=c,c}catch(s){throw console.error("Error al cargar el JSON:",s),s}}return{obtenerDataJson:r}})(),E=(()=>{let t=[],r=[],a={},o=!1,s=!1,c=[],l={};const f=[];let m=-1;async function u(){if(o)return;if(s)return new Promise(n=>c.push(n));s=!0;const e=await I.obtenerDataJson("tokens");t=e.tokens,r=e.directorios,a=e.sintaxis,l=e.significado,o=!0,s=!1,c.forEach(n=>n()),c=[]}async function A(e){await u();const n=e.trim().split(/\s+/),i=[];f.push(e),m=f.length;for(let d=0;d<n.length;d++){const g=n[d].replace(/^\.(\/|\\)/,"");if(i.push(g),!t.includes(g))return{result:"-1",token:`'${n[d]}' no es un comando válido`}}return y(i,i.length)}function y(e,n){if(n===1)return Array.isArray(a[1])&&a[1].includes(e[0])?C(e,n):{result:"-1",token:`Comando inválido: '${e[0]}'`};if(n===2){if(!a.hasOwnProperty(e[0]))return{result:"-1",token:`Comando no reconocido: '${e[0]}'`};const i=a[e[0]];return Array.isArray(i)?i.includes(e[1])?C(e,n):{result:"-1",token:`Argumento inválido para '${e[0]}': '${e[1]}'`}:{result:"-1",token:`Configuración inválida para el comando: '${e[0]}'`}}return{result:"-1",token:"Error de sintaxis general"}}function C(e,n){if(n===1&&(e[0]==="--help"||e[0]==="/?")){const h=v();return{result:h.number,token:h.text}}if(n==2&&(e[1]==="--help"||e[1]==="/?")){const h=v(e[0]);return{result:h.number,token:h.text}}if(n==1&&(e[0]=="cls"||e[0]=="clear"))return{result:2,token:""};const i={ls:h=>b(h),cd:h=>M(),dir:h=>b(h),wget:h=>P(h)};let d="";(e[0]=="ls"||e[0]=="dir")&&(d="todos");const g=i[e[0]](n>1?e[1]:d);return{result:g.number,token:g.text}}function P(e){if(e==="cv"){const n="./document/Jose_Antonio_Rodriguez_Segura.pdf",i=document.createElement("a");return i.href=n,i.download="Jose_Antonio_Rodriguez_Segura.pdf",document.body.appendChild(i),i.click(),document.body.removeChild(i),{number:1,text:"Descargando curriculum vitae..."}}}function _(e,n="comand-0"){let i={up:-1,down:1}[e];if(m+=i,m<0)m=0;else if(m>=f.length)return m=f.length,"";L(n,f[m])}function L(e,n){const i=document.getElementById(e);i&&(i.textContent="root@Antonio_Segura:~# "+n,S(e))}function b(e="todos"){return e==="todos"?{number:1,text:r.join(`
`)}:r.includes(e)?{number:1,text:e}:{number:-1,text:`El directorio '${e}' no existe.`}}function v(e=""){let n="";if(e==="")for(const i in l){const d=l[i];n+=`> ${i}
`,Array.isArray(d)?n+=d.map(g=>`  ${g}`).join(`
`)+`

`:n+=`  ${d}

`}else{if(!l.hasOwnProperty(e))return{number:-1,text:`No hay información de ayuda para '${e}'`};const i=l[e];n+=`> ${e}
`,Array.isArray(i)?n+=i.map(d=>`  ${d}`).join(`
`):n+=`  ${i}`}return{number:3,text:n}}function M(e){return{number:4,text:""}}function B(e,n=""){let i=$(e);n!==""&&D(i,n)}function S(e){const n=document.getElementById(e);if(!n)return;n.focus&&n.focus();const i=document.createRange(),d=window.getSelection();i.selectNodeContents(n),i.collapse(!1),d.removeAllRanges(),d.addRange(i);const g=n.closest(".consola_content");if(!g)return;const h=n.getBoundingClientRect(),p=g.getBoundingClientRect();(h.bottom>p.bottom||h.top<p.top)&&(g.scrollTop=n.offsetTop-g.offsetTop)}function $(e,n="",i="~"){let d="";var g="";let h="afterend";if(n===""){if(g=document.getElementById(e),!g)return;g.classList.remove("prompt");const[k,N]=e.split("-"),T=parseInt(N)+1;d=`${k}-${T}`}else g=n.target,d="comand-0",h="afterbegin";const p=document.createElement("p");return p.className="prompt",p.id=d,p.textContent="root@Antonio_Segura:"+i+"# ",g.insertAdjacentElement(h,p),S(d),d}function D(e,n){const i=document.getElementById(e),d=document.createElement("span");d.textContent=n,i.insertAdjacentElement("beforebegin",d)}function H(e){e.target.innerHTML="",$("",e)}return{lexico:A,insertaNuevoP:B,limpiaPantalla:H,comans:_}})();function q(t){t.addEventListener("scroll",function(o){console.log(o)});const r={ArrowUp:"up",ArrowDown:"down"};if(t._listenerAgregado)return;t._listenerAgregado=!0,t.addEventListener("keydown",function(o){if(o.key==="ArrowUp"||o.key==="ArrowDown"){let s=a(o);E.comans(r[o.key],s[1])}if(o.key==="Enter"){let s=a(o);if(s[2]){const c=s[2].replace(/^root@Antonio_Segura:~#\s*/,"");c!=""?E.lexico(c).then(l=>{if(l.result===2){E.limpiaPantalla(o);return}E.insertaNuevoP(s[1],l.token)}):E.insertaNuevoP(s[1])}}});function a(o){o.preventDefault();const s=t.querySelectorAll("p"),c=s[s.length-1],l=c.id,f=c.innerText.trim();return{1:l,2:f}}}const w=(()=>{const t=new Map,r=["sobre_mi.css","contacto.css","experiencia.css","habilidades.css","inicio.css","proyectos.css","sobre_mi.css","consola.css","menu.css"],a={"sobre_mi.css":"./assets/css/modulos/sobre_mi.css","contacto.css":"./assets/css/modulos/contacto.css","experiencia.css":"./assets/css/modulos/experiencia.css","habilidades.css":"./assets/css/modulos/habilidades.css","inicio.css":"./assets/css/modulos/inicio.css","proyectos.css":"./assets/css/modulos/proyectos.css","consola.css":"./assets/css/componentes/consola.css","menu.css":"./assets/css/componentes/menu.css"};return{cargar:function(o,{forzarRecarga:s=!0}={}){if(!r.includes(o)||!(o in a))return console.log("No, no..."),!1;const c=a[o],l=o.split(".").pop();return new Promise((f,m)=>{if(l==="css"){if(t.has(o)&&!s){f();return}t.has(o)&&(t.get(o).remove(),t.delete(o));const u=document.createElement("link");u.rel="stylesheet",u.href=c,u.onload=()=>{t.set(o,u),f()},u.onerror=m,document.head.insertBefore(u,document.head.firstChild)}else console.log("Tipo de archivo no soportado."),m(new Error("Tipo de archivo no soportado."))})},eliminar:function(o){if(!r.includes(o))return console.log("No, no..."),!1;o.split(".").pop()==="css"&&t.has(o)&&(t.get(o).remove(),t.delete(o))},estaCargado:function(o){return o.split(".").pop()==="css"?t.has(o):!1}}})();function W(t="muestra_consola"){w.cargar("consola.css"),x.cargaModulo("consola",t);const r=document.getElementById(t);r.addEventListener("moduloCargado",function(a){if(a.detail.modulo==="consola"&&!r.querySelector(".consola_content")){console.log("consola no cargada ");return}},{once:!0})}const R={init(){const t=document.getElementById("I_AM");t&&window.innerWidth>=900&&(t.style.height=`${window.innerHeight-54}px`),w.cargar("inicio.css"),W()}},j={init(){const t=document.getElementById("sobre_mi");t&&window.innerWidth>=900&&(t.style.height=`${window.innerHeight-54}px`),J(),w.cargar("sobre_mi.css")}};function J(){const t=document.getElementById("textoSobreMi"),r=document.querySelector(".cards");t.addEventListener("scroll",a=>{const o=window.scrollY,s=.5;r.style.transform=`translateX(-${o*s}px)`})}const O={init(){const t=document.getElementById("contacto");t&&window.innerWidth>=900&&(t.style.height=`${window.innerHeight-54}px`),w.cargar("inicio.css"),U()}};function U(t="[dev-antonio-titulo]"){const r=document.querySelector(t);r?(console.log("Ancho:",r.offsetWidth),console.log("Alto:",r.offsetHeight)):console.warn("No se encontró el elemento")}const z={init(){const t=document.getElementById("proyectos");t&&window.innerWidth>=900&&(t.style.height=`${window.innerHeight-54}px`),w.cargar("inicio.css"),X()}};function X(t="[dev-antonio-titulo]"){const r=document.querySelector(t);r?(console.log("Ancho:",r.offsetWidth),console.log("Alto:",r.offsetHeight)):console.warn("No se encontró el elemento")}const Y={init(){const t=document.getElementById("habilidades");t&&window.innerWidth>=900&&(t.style.height=`${window.innerHeight-54}px`),w.cargar("inicio.css"),F()}};function F(t="[dev-antonio-titulo]"){const r=document.querySelector(t);r?(console.log("Ancho:",r.offsetWidth),console.log("Alto:",r.offsetHeight)):console.warn("No se encontró el elemento")}const G={init(){const t=document.getElementById("experiencia");t&&window.innerWidth>=900&&(t.style.height=`${window.innerHeight-54}px`),w.cargar("inicio.css"),K()}};function K(t="[dev-antonio-titulo]"){const r=document.querySelector(t);r?(console.log("Ancho:",r.offsetWidth),console.log("Alto:",r.offsetHeight)):console.warn("No se encontró el elemento")}const x=(()=>{const t={inicio:()=>{R.init()},consola:()=>{},contacto:()=>{O.init()},proyectos:()=>{z.init()},habilidades:()=>{Y.init()},sobre_mi:()=>{j.init()},experiencia:()=>{G.init()}};function r(a,o="section"){I.obtenerDataJson("allowed_pages").then(s=>{const c=s.idDOMPermitidos,l=s.rutasPermitidas;if(!c.includes(o))throw console.error(`El ID '${o}' no está permitido.`),new Error(`El ID '${o}' no está permitido.`);if(!l[a])throw console.error(`El módulo '${a}' no está permitido.`),new Error(`El módulo '${a}' no está permitido.`);return fetch(l[a])}).then(s=>{if(!s.ok)throw new Error(`Error HTTP: ${s.status}`);return s.text()}).then(s=>{const c=document.getElementById(o);c.innerHTML=s;const l=new CustomEvent("moduloCargado",{detail:{modulo:a,idperm:o}});c.dispatchEvent(l),t[a]()}).catch(s=>{throw console.error("Error al cargar el módulo:",s),s})}return{cargaModulo:r}})(),Q=(()=>{function t(c){const l=c.currentTarget.querySelectorAll("ul"),m=[".menu ul.menu-Principal",".menu ul.menu-flotante"][l.length-1],u=c.currentTarget.querySelector(m);u&&r(c,u,l.length-1==1)}function r(c,l,f=!1){const m=l.querySelectorAll("li"),u=c.target.closest("li");u&&l.contains(u)?a(m,u,f):o(c,l)}function a(c,l,f){try{const m=l.dataset.modulo||l.textContent.trim().toLowerCase();if(x.cargaModulo(m),c.forEach(u=>u.classList.remove("selected")),l.classList.add("selected"),f){const u=document.querySelector(".menu ul.menu-Principal");u&&u.querySelectorAll("li").forEach(y=>{y.classList.remove("selected"),(y.dataset.modulo||y.textContent.trim().toLowerCase())===m&&y.classList.add("selected")}),s()}}catch(m){alert(m)}}function o(c,l){if(s()==="cerrado"||window.innerWidth>980)return;const f=document.createElement("ul");f.className="menu-flotante fadeInDown",l.querySelectorAll("li").forEach(u=>{f.appendChild(u.cloneNode(!0))}),c.target.insertAdjacentElement("afterend",f)}function s(){const c=document.querySelector(".menu-flotante");return c?(c.classList.remove("fadeInDown"),c.classList.add("fadeInUp-Menu"),setTimeout(()=>{c.remove()},750),"cerrado"):"continua"}return{menuActivo:t}})();document.addEventListener("DOMContentLoaded",()=>{x.cargaModulo("inicio"),document.getElementById("header").addEventListener("click",Q.menuActivo),document.getElementById("section").addEventListener("keydown",a=>{a.target.matches(".consola_content")&&q(a.target)})});
