const f=(()=>{const n={};async function r(s){const e={allowed_pages:"./data/allowed_pages.json",commands:"./data/commands.json",contact:"./data/contact.json",technologies:"./data/technologies.json",tokens:"./data/tokens.json"};if(!e[s])throw console.error("El archivo json no existe."),new Error("El archivo json no existe.");if(n[s])return n[s];try{const o=await fetch(e[s]);if(!o.ok)throw new Error(`Error HTTP: ${o.status}`);const t=await o.json();return n[s]=t,t}catch(o){throw console.error("Error al cargar el JSON:",o),o}}return{obtenerDataJson:r}})(),u=(()=>{const n=new Map,r=["sobre_mi.css","contacto.css","experiencia.css","habilidades.css","inicio.css","proyectos.css","sobre_mi.css","consola.css","menu.css"],s={"sobre_mi.css":"./assets/css/modulos/sobre_mi.css","contacto.css":"./assets/css/modulos/contacto.css","experiencia.css":"./assets/css/modulos/experiencia.css","habilidades.css":"./assets/css/modulos/habilidades.css","inicio.css":"./assets/css/modulos/inicio.css","proyectos.css":"./assets/css/modulos/proyectos.css","consola.css":"./assets/css/componentes/consola.css","menu.css":"./assets/css/componentes/menu.css"};return{cargar:function(e,{forzarRecarga:o=!0}={}){if(!r.includes(e)||!(e in s))return console.log("No, no..."),!1;const t=s[e],a=e.split(".").pop();return new Promise((l,i)=>{if(a==="css"){if(n.has(e)&&!o){l();return}n.has(e)&&(n.get(e).remove(),n.delete(e));const c=document.createElement("link");c.rel="stylesheet",c.href=t,c.onload=()=>{n.set(e,c),l()},c.onerror=i,document.head.appendChild(c)}else console.log("Tipo de archivo no soportado."),i(new Error("Tipo de archivo no soportado."))})},eliminar:function(e){if(!r.includes(e))return console.log("No, no..."),!1;e.split(".").pop()==="css"&&n.has(e)&&(n.get(e).remove(),n.delete(e))},estaCargado:function(e){return e.split(".").pop()==="css"?n.has(e):!1}}})();function h(n="muestra_consola"){u.cargar("consola.css");const r=document.getElementById("I_AM");r&&window.innerWidth>=900&&(r.style.height=`${window.innerHeight-54}px`),m.cargaModulo("consola",n);const s=document.getElementById(n);s.addEventListener("moduloCargado",function(e){if(e.detail.modulo==="consola"&&!s.querySelector(".consola_content")){console.log("consola no cargada ");return}},{once:!0})}const g={init(){u.cargar("inicio.css"),h(),p()}};function p(n="[dev-antonio-titulo]"){const r=document.querySelector(n);r?(console.log("Ancho:",r.offsetWidth),console.log("Alto:",r.offsetHeight)):console.warn("No se encontró el elemento")}const E={init(){u.cargar("sobre_mi.css"),cargaConsola(),w()}};function w(n="[dev-antonio-titulo]"){const r=document.querySelector(n);r?(console.log("Ancho:",r.offsetWidth),console.log("Alto:",r.offsetHeight)):console.warn("No se encontró el elemento")}const m=(()=>{const n={inicio:()=>{g.init()},consola:()=>{},contacto:()=>{contacto.init()},proyectos:()=>{proyectos.init()},habilidades:()=>{habilidades.init()},sobre_mi:()=>{E.init()},experiencia:()=>{experiencia.init()}};function r(s,e="section"){f.obtenerDataJson("allowed_pages").then(o=>{const t=o.idDOMPermitidos,a=o.rutasPermitidas;if(!t.includes(e))throw console.error(`El ID '${e}' no está permitido.`),new Error(`El ID '${e}' no está permitido.`);if(!a[s])throw console.error(`El módulo '${s}' no está permitido.`),new Error(`El módulo '${s}' no está permitido.`);return fetch(a[s])}).then(o=>{if(!o.ok)throw new Error(`Error HTTP: ${o.status}`);return o.text()}).then(o=>{const t=document.getElementById(e);t.innerHTML=o;const a=new CustomEvent("moduloCargado",{detail:{modulo:s,idperm:e}});t.dispatchEvent(a),n[s]()}).catch(o=>{throw console.error("Error al cargar el módulo:",o),o})}return{cargaModulo:r}})(),y=(()=>{function n(t){const a=t.currentTarget.querySelectorAll("ul"),i=[".menu ul.menu-Principal",".menu ul.menu-flotante"][a.length-1],c=t.currentTarget.querySelector(i);c&&r(t,c,a.length-1==1)}function r(t,a,l=!1){const i=a.querySelectorAll("li"),c=t.target.closest("li");c&&a.contains(c)?s(i,c,l):e(t,a)}function s(t,a,l){try{const i=a.dataset.modulo||a.textContent.trim().toLowerCase();if(m.cargaModulo(i),t.forEach(c=>c.classList.remove("selected")),a.classList.add("selected"),l){const c=document.querySelector(".menu ul.menu-Principal");c&&c.querySelectorAll("li").forEach(d=>{d.classList.remove("selected"),(d.dataset.modulo||d.textContent.trim().toLowerCase())===i&&d.classList.add("selected")}),o()}}catch(i){alert(i)}}function e(t,a){if(o()==="cerrado")return;const l=document.createElement("ul");l.className="menu-flotante fadeInDown",a.querySelectorAll("li").forEach(c=>{l.appendChild(c.cloneNode(!0))}),t.target.insertAdjacentElement("afterend",l)}function o(){const t=document.querySelector(".menu-flotante");return t?(t.classList.remove("fadeInDown"),t.classList.add("fadeInUp-Menu"),setTimeout(()=>{t.remove()},750),"cerrado"):"continua"}return{menuActivo:n}})();document.addEventListener("DOMContentLoaded",()=>{m.cargaModulo("inicio"),document.getElementById("header").addEventListener("click",y.menuActivo)});
