const _=(()=>{const s={};async function u(i){const n={allowed_pages:"./data/allowed_pages.json",commands:"./data/commands.json",contact:"./data/contact.json",technologies:"./data/technologies.json",tokens:"./data/tokens.json"};if(!n[i])throw console.error("El archivo json no existe."),new Error("El archivo json no existe.");if(s[i])return s[i];try{const o=await fetch(n[i]);if(!o.ok)throw new Error(`Error HTTP: ${o.status}`);const c=await o.json();return s[i]=c,c}catch(o){throw console.error("Error al cargar el JSON:",o),o}}return{obtenerDataJson:u}})(),E=(()=>{let s=[],u=[],i={},n=!1,o=!1,c=[],a={};const f=[];let m=-1;async function d(){if(n)return;if(o)return new Promise(t=>c.push(t));o=!0;const e=await _.obtenerDataJson("tokens");s=e.tokens,u=e.directorios,i=e.sintaxis,a=e.significado,n=!0,o=!1,c.forEach(t=>t()),c=[]}async function b(e){await d();const t=e.trim().split(/\s+/),r=[];f.push(e),m=f.length;for(let l=0;l<t.length;l++){const g=t[l].replace(/^\.(\/|\\)/,"");if(r.push(g),!s.includes(g))return{result:"-1",token:`'${t[l]}' no es un comando válido`}}return y(r,r.length)}function y(e,t){if(t===1)return Array.isArray(i[1])&&i[1].includes(e[0])?x(e,t):{result:"-1",token:`Comando inválido: '${e[0]}'`};if(t===2){if(!i.hasOwnProperty(e[0]))return{result:"-1",token:`Comando no reconocido: '${e[0]}'`};const r=i[e[0]];return Array.isArray(r)?r.includes(e[1])?x(e,t):{result:"-1",token:`Argumento inválido para '${e[0]}': '${e[1]}'`}:{result:"-1",token:`Configuración inválida para el comando: '${e[0]}'`}}return{result:"-1",token:"Error de sintaxis general"}}function x(e,t){if(t===1&&(e[0]==="--help"||e[0]==="/?")){const p=A();return{result:p.number,token:p.text}}if(t==2&&(e[1]==="--help"||e[1]==="/?")){const p=A(e[0]);return{result:p.number,token:p.text}}if(t==1&&(e[0]=="cls"||e[0]=="clear"))return{result:2,token:""};const r={ls:p=>v(p),cd:p=>M(),dir:p=>v(p),wget:p=>I(p)};let l="";(e[0]=="ls"||e[0]=="dir")&&(l="todos");const g=r[e[0]](t>1?e[1]:l);return{result:g.number,token:g.text}}function I(e){if(e==="cv"){const t="./document/Jose_Antonio_Rodriguez_Segura.pdf",r=document.createElement("a");return r.href=t,r.download="Jose_Antonio_Rodriguez_Segura.pdf",document.body.appendChild(r),r.click(),document.body.removeChild(r),{number:1,text:"Descargando curriculum vitae..."}}}function $(e,t="comand-0"){let r={up:-1,down:1}[e];if(m+=r,m<0)m=0;else if(m>=f.length)return m=f.length,"";L(t,f[m])}function L(e,t){const r=document.getElementById(e);r&&(r.textContent="root@Antonio_Segura:~# "+t,P(e))}function v(e="todos"){return e==="todos"?{number:1,text:u.join(`
`)}:u.includes(e)?{number:1,text:e}:{number:-1,text:`El directorio '${e}' no existe.`}}function A(e=""){let t="";if(e==="")for(const r in a){const l=a[r];t+=`> ${r}
`,Array.isArray(l)?t+=l.map(g=>`  ${g}`).join(`
`)+`

`:t+=`  ${l}

`}else{if(!a.hasOwnProperty(e))return{number:-1,text:`No hay información de ayuda para '${e}'`};const r=a[e];t+=`> ${e}
`,Array.isArray(r)?t+=r.map(l=>`  ${l}`).join(`
`):t+=`  ${r}`}return{number:3,text:t}}function M(e){return{number:4,text:""}}function D(e,t=""){let r=S(e);t!==""&&k(r,t)}function P(e){const t=document.getElementById(e);if(!t)return;t.focus&&t.focus();const r=document.createRange(),l=window.getSelection();r.selectNodeContents(t),r.collapse(!1),l.removeAllRanges(),l.addRange(r);const g=t.closest(".consola_content");if(!g)return;const p=t.getBoundingClientRect(),h=g.getBoundingClientRect();(p.bottom>h.bottom||p.top<h.top)&&(g.scrollTop=t.offsetTop-g.offsetTop)}function S(e,t="",r="~"){let l="";var g="";let p="afterend";if(t===""){if(g=document.getElementById(e),!g)return;g.classList.remove("prompt");const[T,N]=e.split("-"),R=parseInt(N)+1;l=`${T}-${R}`}else g=t.target,l="comand-0",p="afterbegin";const h=document.createElement("p");return h.className="prompt",h.id=l,h.textContent="root@Antonio_Segura:"+r+"# ",g.insertAdjacentElement(p,h),P(l),l}function k(e,t){const r=document.getElementById(e),l=document.createElement("span");l.textContent=t,r.insertAdjacentElement("beforebegin",l)}function B(e){e.target.innerHTML="",S("",e)}return{lexico:b,insertaNuevoP:D,limpiaPantalla:B,comans:$}})();function j(s){s.addEventListener("scroll",function(n){console.log(n)});const u={ArrowUp:"up",ArrowDown:"down"};if(s._listenerAgregado)return;s._listenerAgregado=!0,s.addEventListener("keydown",function(n){if(n.key==="ArrowUp"||n.key==="ArrowDown"){let o=i(n);E.comans(u[n.key],o[1])}if(n.key==="Enter"){let o=i(n);if(o[2]){const c=o[2].replace(/^root@Antonio_Segura:~#\s*/,"");c!=""?E.lexico(c).then(a=>{if(a.result===2){E.limpiaPantalla(n);return}E.insertaNuevoP(o[1],a.token)}):E.insertaNuevoP(o[1])}}});function i(n){n.preventDefault();const o=s.querySelectorAll("p"),c=o[o.length-1],a=c.id,f=c.innerText.trim();return{1:a,2:f}}}const w=(()=>{const s=new Map,u=["sobre_mi.css","contacto.css","experiencia.css","habilidades.css","inicio.css","proyectos.css","sobre_mi.css","consola.css","menu.css"],i={"sobre_mi.css":"./assets/css/modulos/sobre_mi.css","contacto.css":"./assets/css/modulos/contacto.css","experiencia.css":"./assets/css/modulos/experiencia.css","habilidades.css":"./assets/css/modulos/habilidades.css","inicio.css":"./assets/css/modulos/inicio.css","proyectos.css":"./assets/css/modulos/proyectos.css","consola.css":"./assets/css/componentes/consola.css","menu.css":"./assets/css/componentes/menu.css"};return{cargar:function(n,{forzarRecarga:o=!0}={}){if(!u.includes(n)||!(n in i))return console.log("No, no..."),!1;const c=i[n],a=n.split(".").pop();return new Promise((f,m)=>{if(a==="css"){if(s.has(n)&&!o){f();return}s.has(n)&&(s.get(n).remove(),s.delete(n));const d=document.createElement("link");d.rel="stylesheet",d.href=c,d.onload=()=>{s.set(n,d),f()},d.onerror=m,document.head.insertBefore(d,document.head.firstChild)}else console.log("Tipo de archivo no soportado."),m(new Error("Tipo de archivo no soportado."))})},eliminar:function(n){if(!u.includes(n))return console.log("No, no..."),!1;n.split(".").pop()==="css"&&s.has(n)&&(s.get(n).remove(),s.delete(n))},estaCargado:function(n){return n.split(".").pop()==="css"?s.has(n):!1}}})();function q(s="muestra_consola"){w.cargar("consola.css"),C.cargaModulo("consola",s);const u=document.getElementById(s);u.addEventListener("moduloCargado",function(i){if(i.detail.modulo==="consola"&&!u.querySelector(".consola_content")){console.log("consola no cargada ");return}},{once:!0})}const H={init(){const s=document.getElementById("I_AM");s&&window.innerWidth>=900&&(s.style.height=`${window.innerHeight-54}px`),w.cargar("inicio.css"),q()}},J={init(){const s=document.getElementById("sobre_mi");s&&window.innerWidth>=900&&(s.style.height=`${window.innerHeight-54}px`),O(),w.cargar("sobre_mi.css")}};function O(){const s=document.getElementById("textoSobreMi"),u=document.querySelector(".cards");s.addEventListener("scroll",i=>{const n=window.scrollY,o=.5;u.style.transform=`translateX(-${n*o}px)`})}const C=(()=>{const s={inicio:()=>{H.init()},consola:()=>{},contacto:()=>{contacto.init()},proyectos:()=>{proyectos.init()},habilidades:()=>{habilidades.init()},sobre_mi:()=>{J.init()},experiencia:()=>{experiencia.init()}};function u(i,n="section"){_.obtenerDataJson("allowed_pages").then(o=>{const c=o.idDOMPermitidos,a=o.rutasPermitidas;if(!c.includes(n))throw console.error(`El ID '${n}' no está permitido.`),new Error(`El ID '${n}' no está permitido.`);if(!a[i])throw console.error(`El módulo '${i}' no está permitido.`),new Error(`El módulo '${i}' no está permitido.`);return fetch(a[i])}).then(o=>{if(!o.ok)throw new Error(`Error HTTP: ${o.status}`);return o.text()}).then(o=>{const c=document.getElementById(n);c.innerHTML=o;const a=new CustomEvent("moduloCargado",{detail:{modulo:i,idperm:n}});c.dispatchEvent(a),s[i]()}).catch(o=>{throw console.error("Error al cargar el módulo:",o),o})}return{cargaModulo:u}})(),U=(()=>{function s(c){const a=c.currentTarget.querySelectorAll("ul"),m=[".menu ul.menu-Principal",".menu ul.menu-flotante"][a.length-1],d=c.currentTarget.querySelector(m);d&&u(c,d,a.length-1==1)}function u(c,a,f=!1){const m=a.querySelectorAll("li"),d=c.target.closest("li");d&&a.contains(d)?i(m,d,f):n(c,a)}function i(c,a,f){try{const m=a.dataset.modulo||a.textContent.trim().toLowerCase();if(C.cargaModulo(m),c.forEach(d=>d.classList.remove("selected")),a.classList.add("selected"),f){const d=document.querySelector(".menu ul.menu-Principal");d&&d.querySelectorAll("li").forEach(y=>{y.classList.remove("selected"),(y.dataset.modulo||y.textContent.trim().toLowerCase())===m&&y.classList.add("selected")}),o()}}catch(m){alert(m)}}function n(c,a){if(o()==="cerrado")return;const f=document.createElement("ul");f.className="menu-flotante fadeInDown",a.querySelectorAll("li").forEach(d=>{f.appendChild(d.cloneNode(!0))}),c.target.insertAdjacentElement("afterend",f)}function o(){const c=document.querySelector(".menu-flotante");return c?(c.classList.remove("fadeInDown"),c.classList.add("fadeInUp-Menu"),setTimeout(()=>{c.remove()},750),"cerrado"):"continua"}return{menuActivo:s}})();document.addEventListener("DOMContentLoaded",()=>{C.cargaModulo("inicio"),document.getElementById("header").addEventListener("click",U.menuActivo),document.getElementById("section").addEventListener("keydown",i=>{i.target.matches(".consola_content")&&j(i.target)})});
