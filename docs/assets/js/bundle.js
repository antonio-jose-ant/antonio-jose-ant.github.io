const I=(()=>{const u={};async function c(a){const i={allowed_pages:"./data/allowed_pages.json",commands:"./data/commands.json",contact:"./data/contact.json",technologies:"./data/technologies.json",tokens:"./data/tokens.json"};if(!i[a])throw console.error("El archivo json no existe."),new Error("El archivo json no existe.");if(u[a])return u[a];try{const l=await fetch(i[a]);if(!l.ok)throw new Error(`Error HTTP: ${l.status}`);const n=await l.json();return u[a]=n,n}catch(l){throw console.error("Error al cargar el JSON:",l),l}}return{obtenerDataJson:c}})();function j(u){u._listenerAgregado||(u._listenerAgregado=!0,u.addEventListener("keydown",function(c){if(c.key==="Enter"){c.preventDefault();const a=u.querySelectorAll("p"),i=a[a.length-1],l=i.id,n=i.innerText.trim();if(n){const s=n.replace(/^root@Antonio_Segura:~#\s*/,"");s!=""?y.lexico(s).then(m=>{if(m.result===2){y.limpiaPantalla(c);return}y.insertaNuevoP(l,m.token)}):y.insertaNuevoP(l)}}}))}const y=(()=>{let u=[],c=[],a={},i=!1,l=!1,n=[],s={};async function m(){if(i)return;if(l)return new Promise(t=>n.push(t));l=!0;const e=await I.obtenerDataJson("tokens");u=e.tokens,c=e.directorios,a=e.sintaxis,s=e.significado,i=!0,l=!1,n.forEach(t=>t()),n=[]}async function p(e){await m();const t=e.trim().split(/\s+/),o=[];for(let r=0;r<t.length;r++){const f=t[r].replace(/^\.(\/|\\)/,"");if(o.push(f),!u.includes(f))return{result:"-1",token:`'${t[r]}' no es un comando válido`}}return d(o,o.length)}function d(e,t){if(t===1)return Array.isArray(a[1])&&a[1].includes(e[0])?w(e,t):{result:"-1",token:`Comando inválido: '${e[0]}'`};if(t===2){if(!a.hasOwnProperty(e[0]))return{result:"-1",token:`Comando no reconocido: '${e[0]}'`};const o=a[e[0]];return Array.isArray(o)?o.includes(e[1])?w(e,t):{result:"-1",token:`Argumento inválido para '${e[0]}': '${e[1]}'`}:{result:"-1",token:`Configuración inválida para el comando: '${e[0]}'`}}return{result:"-1",token:"Error de sintaxis general"}}function w(e,t){if(t===1&&(e[0]==="--help"||e[0]==="/?")){const g=v();return{result:g.number,token:g.text}}if(t==2&&(e[1]==="--help"||e[1]==="/?")){const g=v(e[0]);return{result:g.number,token:g.text}}if(t==1&&(e[0]=="cls"||e[0]=="clear"))return{result:2,token:""};const o={ls:g=>E(g),cd:g=>$(),dir:g=>E(g)};let r="";(e[0]=="ls"||e[0]=="dir")&&(r="todos");const f=o[e[0]](t>1?e[1]:r);return{result:f.number,token:f.text}}function E(e="todos"){return e==="todos"?{number:1,text:c.join(`
`)}:c.includes(e)?{number:1,text:e}:{number:-1,text:`El directorio '${e}' no existe.`}}function v(e=""){let t="";if(e==="")for(const o in s){const r=s[o];t+=`> ${o}
`,Array.isArray(r)?t+=r.map(f=>`  ${f}`).join(`
`)+`

`:t+=`  ${r}

`}else{if(!s.hasOwnProperty(e))return{number:-1,text:`No hay información de ayuda para '${e}'`};const o=s[e];t+=`> ${e}
`,Array.isArray(o)?t+=o.map(r=>`  ${r}`).join(`
`):t+=`  ${o}`}return{number:3,text:t}}function $(e){return{number:4,text:""}}function C(e,t=""){let o=A(e);t!==""&&x(o,t)}function S(e){const t=document.getElementById(e),o=document.createRange(),r=window.getSelection();o.selectNodeContents(t),o.collapse(!1),r.removeAllRanges(),r.addRange(o)}function A(e,t="",o="~"){let r="";var f="";let g="afterend";if(t===""){if(f=document.getElementById(e),!f)return;f.classList.remove("prompt");const[M,D]=e.split("-"),b=parseInt(D)+1;r=`${M}-${b}`}else f=t.target,r="comand-0",g="afterbegin";const h=document.createElement("p");return h.className="prompt",h.id=r,h.textContent="root@Antonio_Segura:"+o+"# ",f.insertAdjacentElement(g,h),S(r),r}function x(e,t){const o=document.getElementById(e),r=document.createElement("span");r.textContent=t,o.insertAdjacentElement("beforebegin",r)}function L(e){e.target.innerHTML="",A("",e)}return{lexico:p,insertaNuevoP:C,limpiaPantalla:L}})();window.agregarEventosInput=j;const P=(()=>{function u(c,a="section"){I.obtenerDataJson("allowed_pages").then(i=>{const l=i.idDOMPermitidos,n=i.rutasPermitidas;if(!l.includes(a))throw console.error(`El ID '${a}' no está permitido.`),new Error(`El ID '${a}' no está permitido.`);if(!n[c])throw console.error(`El módulo '${c}' no está permitido.`),new Error(`El módulo '${c}' no está permitido.`);return fetch(n[c])}).then(i=>{if(!i.ok)throw new Error(`Error HTTP: ${i.status}`);return i.text()}).then(i=>{const l=document.getElementById(a);l.innerHTML=i;const n=new CustomEvent("moduloCargado",{detail:{modulo:c,idperm:a}});if(l.dispatchEvent(n),c==="inicio"){const s=document.getElementById("I_AM");s&&(window.innerWidth>=900&&(s.style.height=`${window.innerHeight-54}px`),_())}}).catch(i=>{throw console.error("Error al cargar el módulo:",i),i})}return{cargaModulo:u}})();function _(u="muestra_consola"){P.cargaModulo("consola",u);const c=document.getElementById(u);c.addEventListener("moduloCargado",function(a){if(a.detail.modulo==="consola"&&!c.querySelector(".consola_content")){console.log("consola no cargada ");return}},{once:!0})}const N=(()=>{function u(n){const s=n.currentTarget.querySelectorAll("ul"),p=[".menu ul.menu-Principal",".menu ul.menu-flotante"][s.length-1],d=n.currentTarget.querySelector(p);d&&c(n,d,s.length-1==1)}function c(n,s,m=!1){const p=s.querySelectorAll("li"),d=n.target.closest("li");d&&s.contains(d)?a(p,d,m):i(n,s)}function a(n,s,m){try{const p=s.dataset.modulo||s.textContent.trim().toLowerCase();if(P.cargaModulo(p),n.forEach(d=>d.classList.remove("selected")),s.classList.add("selected"),m){const d=document.querySelector(".menu ul.menu-Principal");d&&d.querySelectorAll("li").forEach(E=>{E.classList.remove("selected"),(E.dataset.modulo||E.textContent.trim().toLowerCase())===p&&E.classList.add("selected")}),l()}}catch(p){alert(p)}}function i(n,s){if(l()==="cerrado")return;const m=document.createElement("ul");m.className="menu-flotante fadeInDown",s.querySelectorAll("li").forEach(d=>{m.appendChild(d.cloneNode(!0))}),n.target.insertAdjacentElement("afterend",m)}function l(){const n=document.querySelector(".menu-flotante");return n?(n.classList.remove("fadeInDown"),n.classList.add("fadeInUp-Menu"),setTimeout(()=>{n.remove()},750),"cerrado"):"continua"}return{menuActivo:u}})();document.addEventListener("DOMContentLoaded",()=>{P.cargaModulo("inicio"),document.getElementById("header").addEventListener("click",N.menuActivo)});
